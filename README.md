# Customer Churn Prediction and Clustering Analysis
This project is designed to predict customer churn based on a given dataset and to explore clustering techniques for segmenting customers. The script leverages machine learning models such as RandomForestRegressor and KMeans, along with data preprocessing techniques to handle missing values and scale the data.

# Requirements
To run this script, ensure we have the following Python packages installed:
pandas
ydata_profiling
scikit-learn
missforest
lazypredict
matplotlib
scipy

We can install the required libraries using pip:
pip install pandas ydata_profiling scikit-learn missforest lazypredict matplotlib scipy

# Dataset
The dataset used in this project is named CustomerChurn.csv. It contains information about customers, such as their age, tenure, charges, and whether or not they have churned. The target variable is Churn.

# Features of the Script
Exploratory Data Analysis (EDA):
The script uses YData Profiling to generate an exploratory data analysis report (this part is currently commented out).

# Data Preprocessing:
- Converts the TotalCharges column to numeric, handling invalid values.
- Identifies and processes missing data using MissForest (a machine learning imputation technique).
- Scales numerical data using StandardScaler.
- Applies OrdinalEncoder to ordinal features (e.g., ContractType, TechSupport, Gender).
- One-hot encodes nominal features (e.g., InternetService).
- Handles multicollinearity by dropping the TotalCharges column based on a variance inflation factor (VIF) calculation (this part is also commented out).

# Impute missing values using MissForest
miss_forest = MissForest()
x_train_num_imputed = miss_forest.fit_transform(x_train_num)
x_test_num_imputed = miss_forest.transform(x_test_num)

# Modeling:
A RandomForestRegressor model is used to predict churn probability, with hyperparameter tuning via GridSearchCV.
Evaluation metrics like Mean Absolute Error (MAE), Mean Squared Error (MSE), and R-squared (R2) are used to assess model performance.

# Clustering:
A KMeans clustering algorithm is applied to identify customer segments based on the features. The script predicts clusters and outputs the cluster centers.

# Hyperparameter tuning with GridSearchCV
params = {
    "regressor__n_estimators": [50, 100, 200],
    "regressor__criterion": ["squared_error", "absolute_error", "poisson"],
    "regressor__max_depth": [None, 2, 5],
    "regressor__min_samples_split": [2, 5, 10],
}
model = GridSearchCV(model, param_grid=params, scoring="r2", cv=6, verbose=2, n_jobs=6)
model.fit(x_train, y_train)

# Model evaluation metrics
print("MAE: {}".format(mean_absolute_error(y_test, y_predict)))
print("MSE: {}".format(mean_squared_error(y_test, y_predict)))
print("R2: {}".format(r2_score(y_test, y_predict)))

# Apply KMeans clustering
kmeans = KMeans(n_clusters=3, random_state=100)
clusters = kmeans.fit_predict(x_train_processed)

# Output
The script outputs several key pieces of information:
Model Performance: MAE, MSE, and R2 values to assess the performance of the regression model.
Best Hyperparameters: The best parameters found during the grid search.
KMeans Clustering: The cluster centers generated by KMeans.
Processed Data: The processed dataset with KMeans cluster labels attached.

# Notes
The script assumes that the dataset CustomerChurn.csv is in the current working directory.
Some parts of the script, such as generating the profiling report and calculating VIF, are currently commented out.
We may want to modify the number of clusters in KMeans depending on our analysis.
